getwd()
supreme <- read.csv("supreme.csv") # We have 623 observations and 20 variables
str(supreme)       # Internal structure of the dataframe
#head(supreme)    # First part of the dataframe
#summary(supreme) # Summary of the data
rm(list=ls())   # Clear the environment
# setwd("...")  # Setup the working directory
supreme <- read.csv("supreme.csv") # We have 623 observations and 20 variables
str(supreme)       # Internal structure of the dataframe
#head(supreme)    # First part of the dataframe
#summary(supreme) # Summary of the data
View(supreme)
View(supreme)
rm(list=ls())   # Clear the environment
# setwd("...")  # Setup the working directory
rm(list=ls())   # Clear the environment
# setwd("...")  # Setup the working directory
supreme <- read.csv("supreme.csv") # We have 623 observations and 20 variables
str(supreme)       # Internal structure of the dataframe
#head(supreme)    # First part of the dataframe
#summary(supreme) # Summary of the data
stevens$rev <- as.integer((stevens$lctdir=="conser" & stevens$stevdir==0) | (stevens$lctdir=="liberal" & stevens$stevdir==1))
stevens <- subset(supreme[,c("docket","term","stevdir","petit","respon","circuit","unconst","lctdir","issue","result")],supreme$stevdir!=9)
stevens$rev <- as.integer((stevens$lctdir=="conser" & stevens$stevdir==0) | (stevens$lctdir=="liberal" & stevens$stevdir==1))
table(stevens$rev)
if(!require(caTools)){                          # install or load the package
install.packages("caTools")
library(caTools)
}
set.seed(123)                                   # set seed for random sampling
spl <- sample.split(stevens$rev,SplitRatio=0.7) # We use 70% of the data for training
train <- subset(stevens,spl==TRUE);             # training dataset
test <- subset(stevens,spl==FALSE);             # testing dataset
if(!require(caTools)){                          # install or load the package
install.packages("caTools")
library(caTools)
}
set.seed(123)                                   # set seed for random sampling
spl <- sample.split(stevens$rev,SplitRatio=0.7) # We use 70% of the data for training
train <- subset(stevens,spl==TRUE);             # training dataset
test <- subset(stevens,spl==FALSE);             # testing dataset
cart1 <- rpart(rev~petit+respon+circuit+lctdir+issue+unconst,data=train,method="class")
cart1 <- rpart(rev~petit+respon+circuit+lctdir+issue+unconst,data=train,method="class")
if(!require(rpart)){        # rpart is for CART
install.packages("rpart")
library(rpart)
}
cart1 <- rpart(rev~petit+respon+circuit+lctdir+issue+unconst,data=train,method="class")
# Alternative way of building a classification tree
# cart1 <- rpart(as.factor(rev)~petit+respon+circuit+lctdir+issue+unconst,data=train)
print(cart1)
summary(cart1)
plot(cart1); text(cart1)
if(!require(rpart.plot)){
install.packages("rpart.plot")
library(rpart.plot)
}
prp(cart1)
prp(cart1,type=1) # labels all nodes (not just the leaves)
prp(cart1,type=4) # draws separate labels for left and right directions for all nodes and label nodes
prp(cart1,type=4,extra=4) # in addition, this also plots the probability per class of observation
# prp(cart1,type=4,extra=9) # probablities times fraction of observations at the node (the sum across all leaves is 1)
?prp
